// Problem URL: https://leetcode.com/problems/bitwise-ors-of-subarrays/description/

#include "stdafx.h"

#include <iostream>
#include <vector>
#include <set>
#include <algorithm>

using namespace std;

class Solution {
private:
	// This method implements a sliding window, 
	vector<int> processWindow(const vector<int>& arr, size_t windowSize) {
		auto sz = arr.size();
		vector<int> retValues;

		if (windowSize == 0 || windowSize > sz)
			return retValues;

		for (size_t i = 0; i <= sz - windowSize; i++) {
			auto retValue = 0;

			for (size_t j = i; j < i + windowSize; j++)
				retValue |= arr[j];
			
			retValues.push_back(retValue);
		}

		return retValues;
	}

	// The worst solution did not worked
	int subarrayBitwiseORsV2(const vector<int>& inputArray) {
		set<int> uniqueValues;
		set<vector<int>> items;

		for (auto e : inputArray)
			items.insert(vector<int>{e});

		while (true) {
			vector<vector<int>> newItems;

			for (auto row : items) {
				auto v(row);
				
				for (auto item : inputArray) {
					auto candidate(v);
					auto m = find(candidate.begin(), candidate.end(), item);
					
					if( m == candidate.end() ) {
						candidate.push_back(item);

						auto it = find(items.begin(), items.end(), candidate);
						if (it == items.end()) {
							newItems.push_back(candidate);
						}
					}
				}
			}

			if (newItems.size() == 0)
				break;

			for (auto e : newItems)
				items.insert(e);

			newItems.clear();
		}

		for (auto arr : items) {
			int oredSum = 0;
			for (auto num : arr)
				oredSum |= num;

			uniqueValues.insert(oredSum);
		}

		return uniqueValues.size();
	}
public:
	int subarrayBitwiseORs(const vector<int>& inputArray) {
		set<int> uniqueValues;
		
		for (size_t winSize = 1; winSize <= inputArray.size(); winSize++) {
			auto ret = processWindow(inputArray, winSize);
			for (auto e : ret)
				uniqueValues.insert(e);
		}

		return uniqueValues.size();
	}
};

int main() {
	Solution s;
	vector<int> v1{ 2,4,6,7,8,9,12,34 };
	vector<int> inp1{ 1 };
	vector<int> inp2{ 1,1,2 };
	vector<int> inp3{ 1,2,4 };
	vector<int> inp4{ 599,187,674,261,883,475,329,979,17,685,528,538,873,118,361,16,417,353,533,652,916,548,858,1006,685,85,819,1022,522,669,375,319,138,133,230,314,830,976,825,982,222,172,687,30,899,597,546,233,216,779 };
	vector<int> tle2{57965408, 732488978, 700799128, 768809721, 523553835, 711881158, 328531453, 337417910, 179126815, 960829698, 660506301, 873206369, 739109388, 247940440, 326125454, 608759145, 281736923, 337449645, 337174779, 578675307, 441886584, 185832936, 199793708, 379385797, 292332963, 963953458, 724956694, 424983067, 252723770, 594775583, 110287803, 227089026, 921756193, 538827766, 849835558, 212145592, 22923042, 898661075, 163112841, 132146383, 911603849, 91154243, 206758864, 183318271, 879251320, 723290098, 919434629, 276087823, 257336333, 734811221, 395278783, 122814564, 104307826, 818553198, 987274863, 554943104, 679438684, 373341576, 127449835, 953589741, 847860170, 443749613, 509106184, 471146390, 657390609, 53936951, 686072011, 532219835, 393042419, 596098658, 918940356, 643792744, 777204586, 192417486, 10759191, 512867218, 490313839, 371356058, 363861641, 67384949, 861310233, 898944406, 555287468, 942975770, 35336874, 725460838, 584663610, 941838506, 767406524, 340253232, 89439267, 702693807, 207262817, 195602005, 386064476, 510254298, 233768867, 80738986, 434665041, 940693724, 804646894, 767196755, 618152175, 382057874, 310441944, 977445472, 527369100, 683717486, 8859226, 46229705, 233311871, 712025404, 310856618, 847874577, 111943911, 545858140, 405864793, 224662344, 29298629, 126023761, 407435386, 623471818, 466218272, 775000238, 131134529, 364051841, 588775537, 591176565, 982231656, 902442566, 354602691, 871892073, 554519985, 808070336, 118109382, 993351444, 176770892, 496573541, 903359428, 350703157, 370527504, 749341349, 941991851, 581202886, 988484618, 532238422, 984529947, 537116627, 404835807, 297671323, 750890975, 654534183, 580246607, 162880389, 976891593, 42034432, 153201956, 694152695, 194213406, 235672067, 773382894, 291905540, 102786600, 556717272, 795087360, 457564185, 113020733, 466644252, 432259551, 569846951, 2873538, 206846462, 746754645, 94275888, 77731556, 712181336, 758360688, 550177879, 451734330, 107299553, 493294611, 695433708, 386588399, 615449911, 767827232, 560813354, 175100636, 65576007, 599243755, 314447482, 77608370, 175326140, 611130562, 550337634, 210341609, 457716792, 122635833, 769853431, 411541697, 330737111, 163686226, 692161294, 504966176, 475226606, 297155154, 618429694, 360199504, 875406935, 291431104, 933601819, 766882412, 394913146, 965217325, 447202504, 478206902, 85394038, 577243143, 123820527, 445367926, 584874700, 525050961, 634846887, 883067045, 221171001, 618954543, 69490695, 167470625, 907208969, 751737628, 176238898, 375951461, 491002719, 780345053, 677425923, 696326156, 106184401, 317303143, 406054531, 29488944, 546812350, 457301359, 870970427, 621174324, 868502600, 951509799, 442927862, 570218443, 958542728, 331590864, 346475829, 194848522, 378181649, 944918283, 400937027, 739559306, 120090460, 665880153, 403043227, 267103545, 952667794, 71157265, 833133354, 486690775, 322346687, 494898765, 333622350, 402048455, 315246241, 159175766, 429014687, 104600559, 606246027, 608814, 922958278, 745035410, 419418118, 45414627, 313100497, 99996329, 396833050, 928218694, 246777576, 139743362, 88295521, 55381584, 239494120, 158364242, 487515878, 313685447, 409689464, 708700111, 107289243, 967091782, 6323320, 192750274, 301873851, 100947727, 25502746, 121628682, 596205929, 233538344, 669366992, 571254233, 614577537, 662841804, 149350690, 715799261, 505262787, 558746916, 817704060, 122285067, 269763887, 643529831, 584061060, 137980863, 749319555, 846615956, 605124511, 33901814, 897796781, 233500472, 349033895, 209067378, 991743099, 932331841, 448240121, 699499613, 310295318, 223040320, 460524428, 501940772, 751068699, 605326022, 694235427, 970975970, 951221, 758711894, 540372982, 261694092, 4567486, 458523624, 89977713, 75596922, 565745754, 63643385, 672861141, 306147218, 149424398, 452238303, 163606397, 971313339, 392214135, 603276780, 590292199, 134937006, 250469424, 47419999, 738785620, 472462762, 17258991, 160549481, 855187650, 80046056, 499907932, 950371145, 338715591, 355720401, 241692088, 599092014, 580823461, 666674944, 901038668, 21937911, 999824459, 197903672, 695968145, 771794487, 599521778, 278336759, 883457042, 334332153, 385778111, 482662460, 286336092, 62705563, 968591004, 149045148, 29255429, 259025610, 889976048, 890319488, 265137856, 882860314, 436527606, 397251012, 160710822, 268420290, 973716530, 57668582, 284937808, 296191817, 576244333, 242160490, 836043443, 204836026, 344373758, 782535497, 539512110, 327105482, 542056068, 795426256, 825656051, 813217471, 475078225, 430594981, 145535257, 481628736, 508930136, 613746053, 348957762, 954829123, 827968817, 258420195, 469487198, 417699241, 933038479, 629527634, 242085479, 90723859, 425453754, 686236966, 494867573, 47394904, 202896489, 320481736, 804791223, 834187023, 3319612, 914097834, 722972180, 798466645, 868560075, 48844421, 595392324, 973167596, 533159232, 786511973, 834726121, 852873148, 621649148, 45129793, 458755041, 953979367, 347182506, 390446064, 135698958, 405696223, 596391059, 47091415, 112758721, 433212871, 854345622, 522597640, 575194985, 961623892, 18264118, 131817850, 445212889, 964780165, 237341151, 893996236, 279645412, 237300799, 415783344, 741542555, 712751249, 832044805, 428670788, 190110702, 288877134, 291664044, 648547076, 724924305, 583330184, 952769464, 575651169, 893267434, 250881189, 221450053, 471493930, 128271088, 921269556, 200698535, 855190209, 684704574, 258432107, 835981807, 86625871, 689972696, 777137025, 122409599, 974274848, 115956451, 575287409, 196364626, 739101598, 996455992, 572824476, 355855325, 202267447, 280260138, 333400417, 650587296, 520778388, 286261771, 409058153, 174279181, 976659430, 852226545, 335136746, 812710354, 147045099, 297585089, 666794899, 828540377, 234094443, 763984186, 61878323, 132205375, 550704277, 124515389, 105814396, 511663525, 438954752, 997240634, 199368221, 31212125, 471470372, 760413326, 134454986, 283987355, 283945436, 494712299, 312040365, 405085773, 767325365, 225706645, 944116675, 214983944, 512414073, 206057791, 738548357, 720794656, 833791052, 212865447, 65737897, 225384339, 495326678, 380555829, 71057320, 852448860, 309103014, 345626761, 723218813, 857948164, 825954941, 109080157, 649804109, 901228748, 356563161, 324385721, 903008755, 654078081, 953847099, 180061568, 777253003, 142498311, 321986876, 929920968, 654805445, 583354951, 145930618, 878007333, 632853374, 519589679, 648325561, 766637374, 64536299, 239030639, 892444505, 898946564, 498084917, 883419572, 645547655, 567418827, 307707102, 342468777, 356319938, 97224447, 882444991, 548211467, 589664892, 780626403, 755533219, 672028957, 768492446, 494986341, 175035958, 379520338, 155650816, 115922475, 121410657, 148358287, 887522688, 876056648, 49514152, 898501285, 81370068, 617917195, 976203716, 401037284, 781277304, 308860880, 220996755, 74925194, 698311216, 569029621, 976957324, 407381427, 500174798, 389382851, 18165586, 69931669, 344245218, 712417506, 37497336, 198743414, 398865424, 708741922, 982321225, 500242072, 407172888, 632944910, 39009176, 900307289, 967270476, 675524084, 730384380, 69885426, 266475545, 75187313, 158244811, 732784448, 854359146, 34911179, 697391850, 528107401, 936097937, 721607839, 329013861, 460552143, 891426598, 595669604, 902758064, 774183172, 306010307, 109973321, 51235202, 253791590, 597045079, 648296759, 318281066, 571561883, 419098543, 915530111, 266291930, 803750986, 39854776, 851119057, 369075056, 482008416, 857319567, 616200883, 858605658, 301041856, 978175254, 389443733, 888424357, 594598556, 609988141, 843536483, 919989861, 349549043, 283453720, 112191181, 270760414, 118929648, 644945324, 598372321, 424434080, 431626154, 559821339, 475206921, 43388100, 784835243, 49218926, 451942025, 224801385, 869381930, 582580688, 789507840, 140250055, 443659464, 975996807, 190636141, 313239787, 621762094, 480832286, 502984024, 349657432, 55192605, 945042341, 596819911, 725443871, 115087486, 104906977, 155364321, 29527824, 396676402, 104209722, 258663050, 702682014, 753924416, 572695936, 948978699, 936366364, 570987012, 458404082, 310103859, 253252183, 951822489, 46500345, 814868504, 257124842, 156433479, 140326822, 40852601, 438738627, 682108649, 657418365, 833726088, 920274086, 514402396, 473145716, 21511897, 920041755, 267767305, 318309477, 297022593, 296729283, 86559525, 650452402, 481288564, 480052841, 225124255, 547019638, 265709843, 747777652, 994914130, 36894664, 879680, 584496169, 982309699, 181663273, 680641876, 141184531, 505287170, 2831111, 298229350, 83115857, 901469183, 513296101, 66645253, 242935541, 787671098, 961063358, 851568526, 516245087, 638292615, 697775138, 38868258, 234148868, 771748470, 542622269, 89589527, 947447247, 682831707, 799615250, 338140448, 358987897, 695947252, 395815826, 440785635, 892293812, 357499453, 546773468, 518258897, 468683435, 874630460, 456820726, 654904537, 716046026, 369681852, 325358386, 621734723, 943441751, 314898960, 225758333, 664031516, 423720577, 413508114, 461252099, 485857489, 56856150, 77549212, 524712847, 626799968, 89499722, 670898619, 792650549, 607564179, 553800029, 860303198, 673139043, 300117023, 248243529, 375091634, 76770165, 417786407, 865245115, 236045452, 274283765, 129252716, 658688853, 954297317, 167416990, 52035373, 594599877, 308714654, 22896974, 758784590, 539501671, 477212173, 599768868, 695162726, 310212764, 947251472, 945277770, 428013991, 844159800, 812718119, 920861057, 146710835, 684581798, 418506522, 466166963, 239014121, 537316266, 800914349, 918835942, 577030019, 515068398, 502746030, 708673419, 366747226, 209458248, 63062565, 784048151, 633061915, 383071655, 496670063, 574503376, 61214289, 380824840, 152240103, 207490806, 602591556, 130718583, 786298229, 288811631, 290105922, 309925724, 186276711, 813877978, 514846949, 810282275, 582333365, 949737541, 138907829, 508567564, 839713399, 125821949, 300312611, 7875011, 994719117, 799083361, 185443880, 412146083, 132750202, 597398818, 49302300, 321875393, 583987003, 641787781, 296375244, 923447465, 283692803, 150416613, 402670066, 53469349, 920403000, 943979489, 131621184, 818761170, 440466863, 748622941, 523386079, 824560813, 396953546, 588977769, 469205194, 439388558, 63211052, 48841672, 173520728, 489671966, 530983028, 511636715, 442163922, 837813661, 973460510, 462535674, 831205063, 799227457, 702819342, 367285358, 520102033, 193542984, 698614651, 245057156, 923299169, 427288703, 898826055, 227445653, 138873824, 171797409, 765191411, 28808638, 402023400, 109370602, 112429401, 57192545, 49191873, 873623608, 750406540, 207485052, 723693302, 595043994, 625995367, 618272024, 726556951, 551048879, 93599813, 77108909, 142821641, 258022816, 695305964, 818237764, 329830955, 274641585, 266301723, 8656074, 42228691, 803916355, 755312140, 647882637, 696711478, 149821838, 794239169, 892682160, 809336329, 943681363, 468074442, 180897401, 664483485, 774013879, 738457351, 840967829, 277776505, 878513030};

	cout << s.subarrayBitwiseORs(inp1) << endl;     // Should output 1
	cout << s.subarrayBitwiseORs(inp2) << endl;     // Should output 3
	cout << s.subarrayBitwiseORs(inp3) << endl;     // Should output 6
	cout << s.subarrayBitwiseORs(inp4) << endl;     // Got fixed but still 
	cout << s.subarrayBitwiseORs(tle2) << endl;

	return 0;
}
